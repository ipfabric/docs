default:
  tags:
    - lowperf

image: debian:bookworm
deploy_to_production:
  stage: deploy
  only:
    - gh-pages
  script:
    - apt-get install --yes curl zstd
    - /usr/bin/tar --create --exclude-from=deploy-exclude.lst --use-compress-program='/usr/bin/zstd -T0 -9' --file=/tmp/ipf-docs-site.tar.zst ./
    - /usr/bin/curl --fail --location --user "$UPLOAD_CREDENTIALS" --upload-file /tmp/ipf-docs-site.tar.zst https://docs-upload.ipf.cx/upload/ipf-docs-site.tar.zst
